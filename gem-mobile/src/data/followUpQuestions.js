/**
 * Follow-up Questions - Câu hỏi follow-up theo topic
 * Dùng để kích thích user chat tiếp
 */

export const FOLLOW_UP_QUESTIONS = {
  // Tiền bạc
  money: [
    'Bạn có muốn tôi phân tích sâu hơn về 1 trong 3 lỗi tâm thức không?',
    'Bạn đã thử manifest tiền bạc trước đây chưa? Kết quả thế nào?',
    'Trong 3 dấu hiệu nghiệp tiền, bạn thấy mình có dấu hiệu nào rõ nhất?',
    'Bạn muốn tôi hướng dẫn chi tiết bài tập "Chi tiền trong Hạnh phúc" không?',
    'Bạn có muốn tạo Vision Board tài chính 2025 ngay bây giờ không?',
    'Gia đình bạn thường nói gì về tiền bạc khi bạn còn nhỏ?',
    'Bạn có hay lo lắng khi phải chi một khoản tiền lớn không?',
  ],

  money_karma: [
    'Bạn nhận thấy dấu hiệu nào trong 3 dấu hiệu nghiệp tiền tôi vừa nêu?',
    'Bạn có muốn làm bài tập 21 ngày để chuyển hóa nghiệp tiền không?',
    'Tiền bạc có phải là chủ đề nhạy cảm trong gia đình bạn không?',
    'Bạn có muốn tôi giúp xác định niềm tin gốc về tiền từ gia đình không?',
  ],

  money_block: [
    'Bạn có muốn tôi phân tích sâu hơn về block tiền của bạn không?',
    'Bạn thường có cảm giác gì khi nhận được tiền?',
    'Bạn có muốn thử bài tập "Chi tiền trong Hạnh phúc" ngay hôm nay không?',
  ],

  // Tình yêu
  love: [
    'Bạn có nhận ra pattern nào lặp lại trong các mối quan hệ trước không?',
    'Bạn có muốn tôi hướng dẫn bài tập tha thứ để release nghiệp tình cũ không?',
    'Mối quan hệ gần nhất của bạn kết thúc vì lý do gì?',
    'Bạn có muốn tạo Vision Board về mối quan hệ lý tưởng không?',
    'Bạn đã bao giờ thử thiền chữa lành inner child chưa?',
    'Bạn cảm thấy thế nào khi ở một mình?',
    'Bạn có sợ bị tổn thương nếu yêu lại không?',
  ],

  love_karma: [
    'Bạn có thấy mình lặp lại cùng một sai lầm trong các mối quan hệ không?',
    'Bạn có muốn tôi phân tích pattern tình yêu của bạn không?',
    'Mối quan hệ đầu tiên của bạn như thế nào?',
    'Bạn có muốn tôi giúp tìm ra nghiệp tình từ quá khứ không?',
  ],

  wrong_person: [
    'Những người bạn thường thu hút có điểm gì chung?',
    'Bạn có muốn biết cách nâng tần số để thu hút người phù hợp không?',
    'Bạn định nghĩa "người đúng" là như thế nào?',
    'Bạn có muốn tôi phân tích tần số tình yêu hiện tại của bạn không?',
  ],

  // Tần số
  frequency: [
    'Bạn có muốn tôi gợi ý lộ trình nâng tần số trong 21 ngày không?',
    'Ngoài vấn đề này, bạn còn cảm thấy tắc nghẽn ở lĩnh vực nào khác không?',
    'Bạn thường thiền vào thời điểm nào trong ngày?',
    'Bạn có muốn tôi tạo playlist affirmation riêng cho bạn không?',
    'Bạn có theo dõi cảm xúc của mình hàng ngày không?',
    'Bạn muốn tập trung nâng tần số ở lĩnh vực nào trước - tiền bạc hay tình yêu?',
  ],

  // Nghiệp
  karma: [
    'Bạn có muốn bắt đầu hành trình 21 ngày chuyển hóa nghiệp không?',
    'Bạn nghĩ nghiệp của mình đến từ đâu - gia đình hay trải nghiệm cá nhân?',
    'Bạn có sẵn sàng tha thứ để giải phóng năng lượng cũ không?',
    'Bạn có muốn tôi giúp xác định loại nghiệp đang ảnh hưởng đến bạn không?',
    'Bạn đã từng viết thư tha thứ cho ai chưa?',
  ],

  // Crystal
  crystal: [
    'Bạn đã có viên đá nào chưa, hay cần tôi gợi ý?',
    'Bạn có muốn tôi hướng dẫn cách sạc và kích hoạt đá không?',
    'Bạn thường thiền vào lúc nào? Tôi sẽ gợi ý cách kết hợp đá.',
    'Bạn muốn dùng đá cho mục đích gì - tiền bạc, tình yêu, hay tâm linh?',
    'Bạn có biết chakra nào của mình đang cần được kích hoạt không?',
  ],

  // Vision Board
  vision_board: [
    'Bạn muốn tạo Vision Board cho lĩnh vực nào - Tiền bạc hay Tình yêu?',
    'Mục tiêu lớn nhất của bạn trong 2025 là gì?',
    'Bạn có hình dung rõ cuộc sống lý tưởng của mình chưa?',
    'Bạn có muốn tôi giúp bạn đặt mục tiêu cụ thể với con số và deadline không?',
    'Bạn đã từng tạo vision board truyền thống (giấy) chưa?',
  ],

  // Chung
  general: [
    'Còn điều gì bạn muốn tôi phân tích thêm không?',
    'Bạn có câu hỏi gì khác cho tôi không?',
    'Điều gì đang khiến bạn suy nghĩ nhiều nhất lúc này?',
    'Bạn cảm thấy thế nào sau khi đọc phân tích này?',
    'Có lĩnh vực nào khác trong cuộc sống bạn muốn tôi giúp không?',
    'Bạn có muốn tôi tạo cho bạn một Widget để thực hành hàng ngày không?',
  ],
};

/**
 * Get random follow-up question for a topic
 * @param {string} topic - Topic category
 * @returns {string} - Random follow-up question
 */
export const getFollowUpQuestion = (topic) => {
  const questions = FOLLOW_UP_QUESTIONS[topic] || FOLLOW_UP_QUESTIONS.general;
  const randomIndex = Math.floor(Math.random() * questions.length);
  return questions[randomIndex];
};

/**
 * Get multiple follow-up questions for a topic
 * @param {string} topic - Topic category
 * @param {number} count - Number of questions to return
 * @returns {Array<string>} - Array of follow-up questions
 */
export const getMultipleFollowUpQuestions = (topic, count = 3) => {
  const questions = FOLLOW_UP_QUESTIONS[topic] || FOLLOW_UP_QUESTIONS.general;
  const shuffled = [...questions].sort(() => 0.5 - Math.random());
  return shuffled.slice(0, count);
};

/**
 * Detect topic from user message for follow-up
 * @param {string} message - User message
 * @returns {string} - Detected topic
 */
export const detectTopicForFollowUp = (message) => {
  const lowerMessage = message.toLowerCase();

  if (lowerMessage.includes('tiền') || lowerMessage.includes('tài chính')) {
    if (lowerMessage.includes('nghiệp') || lowerMessage.includes('karma')) {
      return 'money_karma';
    }
    if (lowerMessage.includes('block') || lowerMessage.includes('tắc')) {
      return 'money_block';
    }
    return 'money';
  }

  if (lowerMessage.includes('tình yêu') || lowerMessage.includes('quan hệ')) {
    if (lowerMessage.includes('nghiệp') || lowerMessage.includes('karma')) {
      return 'love_karma';
    }
    if (lowerMessage.includes('sai người')) {
      return 'wrong_person';
    }
    return 'love';
  }

  if (lowerMessage.includes('tần số') || lowerMessage.includes('năng lượng')) {
    return 'frequency';
  }

  if (lowerMessage.includes('nghiệp') || lowerMessage.includes('karma')) {
    return 'karma';
  }

  if (lowerMessage.includes('đá') || lowerMessage.includes('crystal')) {
    return 'crystal';
  }

  if (lowerMessage.includes('vision board') || lowerMessage.includes('mục tiêu')) {
    return 'vision_board';
  }

  return 'general';
};

export default {
  FOLLOW_UP_QUESTIONS,
  getFollowUpQuestion,
  getMultipleFollowUpQuestions,
  detectTopicForFollowUp,
};
